<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>knitter.webelement &#8212; Automation API lib 1.0.0 文档</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="top" title="Automation API lib 1.0.0 文档" href="../../index.html" />
    <link rel="up" title="模块代码" href="../index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>knitter.webelement 源代码</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    knitter.webelement</span>
<span class="sd">    ~~~~~~~~~~~~~~</span>

<span class="sd">    Browser operation and dom element operation.</span>

<span class="sd">    :copyright: (c) 2016 by Emma.</span>
<span class="sd">    :license: Schneider Electric, see LICENSE for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="k">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="k">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="k">import</span> <span class="n">NoSuchElementException</span><span class="p">,</span> <span class="n">NoAlertPresentException</span><span class="p">,</span> <span class="n">UnexpectedAlertPresentException</span><span class="p">,</span> <span class="n">WebDriverException</span>
<span class="kn">from</span> <span class="nn">httplib</span> <span class="k">import</span> <span class="n">BadStatusLine</span>

<span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">env</span><span class="o">,</span> <span class="nn">log</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">isNumberType</span>


<span class="k">class</span> <span class="nc">compatiblemethod</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;If the first argument(cls) is a class, set/use properties of the class. If the </span>
<span class="sd">    first argument is a instance, set/use properties of the instance.</span>
<span class="sd">    </span>
<span class="sd">    This is an extention version for &quot;@classmethod&quot;, used for multi-thread issues</span>
<span class="sd">    of the framework.</span>
<span class="sd">    </span>
<span class="sd">    EXAMPLE</span>
<span class="sd">    </span>
<span class="sd">        class A:</span>
<span class="sd">            a = 0</span>
<span class="sd">            </span>
<span class="sd">            @compatiblemethod</span>
<span class="sd">            def test(cls, aaa):</span>
<span class="sd">                cls.a = aaa</span>
<span class="sd">        </span>
<span class="sd">            @compatiblemethod</span>
<span class="sd">            def get(cls):</span>
<span class="sd">                print &quot;get &quot;, cls.a</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">method</span>
    
    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">klass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        
        <span class="c1">### this is the different part with &quot;classmethod&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">klass</span><span class="p">):</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">klass</span><span class="o">.</span><span class="n">__name__</span> <span class="o">=</span> <span class="n">klass</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
        
        <span class="k">def</span> <span class="nf">newfunc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">newfunc</span>




<span class="k">class</span> <span class="nc">WebBrowser</span><span class="p">:</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">ScrollTo</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Scroll To [</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;window.scrollTo(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">);&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Refresh</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Browser Refresh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">key_down</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">F5</span><span class="p">)</span><span class="o">.</span><span class="n">key_up</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">DeleteAllCookies</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Browser Delete All Cookies&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">delete_all_cookies</span><span class="p">()</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">NavigateTo</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Navigate To [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">IESkipCertError</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;IE Skip SSL Cert Error.&quot;</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;javascript:document.getElementById(&#39;overridelink&#39;).click();&quot;</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">AlertAccept</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;AlertAccept()&quot;</span><span class="p">)</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;switch_to_alert()&quot;</span><span class="p">)</span>
            <span class="n">alert</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span>
            <span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Alert Not Found. &quot;</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;switch_to_default_content()&quot;</span><span class="p">)</span>
            <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to_default_content</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">AlertDismiss</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;AlertDismiss()&quot;</span><span class="p">)</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;switch_to_alert()&quot;</span><span class="p">)</span>
            <span class="n">alert</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span>
            <span class="n">alert</span><span class="o">.</span><span class="n">dismiss</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Alert Not Found.&quot;</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;switch_to_default_content()&quot;</span><span class="p">)</span>
            <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to_default_content</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">AlertSendKeys</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;AlertSendKeys [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">default_content</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()))</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">AlertTextHave</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">txt_value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;AlertTextHave [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">txt_value</span><span class="p">)</span>
        <span class="n">alert_text</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">txt_value</span> <span class="ow">in</span> <span class="n">alert_text</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;fail&quot;</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to_default_content</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SwitchToNewPopWindow</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;SwitchToNewPopWindow()&quot;</span><span class="p">)</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span><span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">window_handles</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Pop Window Not Found. Wait 3 Seconds then Try Again!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Switch To The New Window of : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">window_handles</span><span class="p">))</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SwitchToDefaultWindow</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;SwitchToDefaultWindow()&quot;</span><span class="p">)</span>
        
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Switch To The Default Window of: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">window_handles</span><span class="p">))</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;env.threadlocal.BROWSER.switch_to.window(env.threadlocal.BROWSER.window_handles[0])&quot;</span><span class="p">)</span>
            <span class="k">pass</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SwitchToFrame</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;SwitchToFrame()&quot;</span><span class="p">)</span>

<span class="c1">#       env.threadlocal.BROWSER.switch_to_frame(frame)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SwitchToDefaultContent</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;SwitchToDefaultContent()&quot;</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
<span class="c1">#           env.threadlocal.BROWSER.switch_to_default_content()</span>
            <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">default_content</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;env.threadlocal.BROWSER.switch_to.default_content()&quot;</span><span class="p">)</span>
            <span class="k">pass</span>




<div class="viewcode-block" id="WebElement"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement">[文档]</a><span class="k">class</span> <span class="nc">WebElement</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">index</span>       <span class="o">=</span> <span class="mi">0</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">by</span> <span class="o">=</span> <span class="n">by</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">ScrollIntoView</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: ScrollToView()&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#=======================================================================</span>
        <span class="c1"># print elements[cls.index].location</span>
        <span class="c1"># print elements[cls.index].rect</span>
        <span class="c1"># print elements[cls.index].location_once_scrolled_into_view</span>
        <span class="c1">#=======================================================================</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
            <span class="n">WebBrowser</span><span class="o">.</span><span class="n">ScrollTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">10</span>
            
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;still not displayed. break out.&quot;</span><span class="p">)</span>
        
        <span class="c1">#=======================================================================</span>
        <span class="c1"># x = elements[cls.index].location_once_scrolled_into_view[&#39;x&#39;]</span>
        <span class="c1"># y = elements[cls.index].location_once_scrolled_into_view[&#39;y&#39;]</span>
        <span class="c1"># </span>
        <span class="c1"># log.step_normal(&quot;Element [%s]: Position = [%s]&quot; % (cls.__name__, str(elements[cls.index].location_once_scrolled_into_view)))</span>
        <span class="c1"># </span>
        <span class="c1"># WebBrowser.ScrollTo(int(x/2), int(y/2))</span>
        <span class="c1"># </span>
        <span class="c1"># time.sleep(1)</span>
        <span class="c1">#=======================================================================</span>
        
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Set</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Set [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">isNumberType</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;select&quot;</span> <span class="ow">or</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;ul&quot;</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">send_keys_to_element</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
            
            <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SelectByPartial</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Select [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">is_selected</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1">#### select ################</span>
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;select&quot;</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                    <span class="n">option</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="n">is_selected</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
        
        <span class="c1">#### ul ################</span>
        <span class="k">elif</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;ul&quot;</span><span class="p">:</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span>  <span class="n">li</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                    <span class="n">li</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="n">is_selected</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
        
        <span class="c1">#### NOT Supported ################</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Tag [</span><span class="si">%s</span><span class="s2">] NOT support [Select] method&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span><span class="p">))</span>
        
        
        <span class="k">if</span> <span class="n">is_selected</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;No item selected!&quot;</span><span class="p">)</span>
        
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Select</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Select [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">is_selected</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1">#### select ################</span>
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;select&quot;</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
<span class="c1">#                 log.step_normal(&quot;Element [%s]: option [%s]&quot; % (cls.__name__, option.text))</span>
                
                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">option</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="n">is_selected</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
        
        <span class="c1">#### ul ################</span>
        <span class="k">elif</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;ul&quot;</span><span class="p">:</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
<span class="c1">#                 log.step_normal(&quot;Element [%s]: li [%s]&quot; % (cls.__name__, li.text))</span>
                
                <span class="k">if</span> <span class="n">li</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">li</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="n">is_selected</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
        
        <span class="c1">#### NOT Supported ################</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Tag [</span><span class="si">%s</span><span class="s2">] NOT support [Select] method&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span><span class="p">))</span>
        
        
        <span class="k">if</span> <span class="n">is_selected</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;No item selected!&quot;</span><span class="p">)</span>
        
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SelectByOrder</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Select by Order [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
        
        <span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="c1">#### ul ################</span>
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;ul&quot;</span><span class="p">:</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                
                <span class="c1">### Wait and try more times if NO item found. ###</span>
                <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">lis</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Wait 3 Seconds for [li]&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">20</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: List Count = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)))</span>
                        <span class="k">return</span>
                
                
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: List Count = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)))</span>
                
                <span class="k">if</span> <span class="p">(</span><span class="n">order</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)):</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Not so many lists. [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Do Click [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
                    <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
                    
                    <span class="c1"># Added to avoid error: &quot;Element is no longer attached to the DOM&quot;</span>
                    <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">lis</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">)</span>
                    
                    <span class="n">action</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">lis</span><span class="p">[</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
                    
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Order = [</span><span class="si">%s</span><span class="s2">], Value Error.&quot;</span> <span class="o">%</span> <span class="n">order</span><span class="p">)</span>
                
                
        <span class="c1">#### select ################</span>
        <span class="c1">#### if elements[cls.index].tag_name == &quot;select&quot;:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                
                <span class="c1">### Wait and try more times if NO item found. ###</span>
                <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">options</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Wait 3 Seconds for [option]&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">20</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: options Count = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)))</span>
                        <span class="k">return</span>
                
                
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: options Count = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)))</span>
                
                <span class="k">if</span> <span class="p">(</span><span class="n">order</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)):</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Not so many options. [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Do Click [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
                    <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
                    <span class="n">action</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Order = [</span><span class="si">%s</span><span class="s2">], Value Error.&quot;</span> <span class="o">%</span> <span class="n">order</span><span class="p">)</span>
        
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">MouseOver</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: MouseOver()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">MoveByOffset</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">xoffset</span><span class="p">,</span> <span class="n">yoffset</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: MoveByOffset()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span><span class="o">.</span><span class="n">move_by_offset</span><span class="p">(</span><span class="n">xoffset</span><span class="p">,</span> <span class="n">yoffset</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Click</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Click()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        
        
        <span class="c1">#=======================================================================</span>
        <span class="c1"># action = webdriver.ActionChains(env.threadlocal.BROWSER)</span>
        <span class="c1"># action.key_up(Keys.CONTROL, elements[cls.index])</span>
        <span class="c1"># action.perform()</span>
        <span class="c1"># </span>
        <span class="c1"># action.click(elements[cls.index])</span>
        <span class="c1"># action.perform()</span>
        <span class="c1">#=======================================================================</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>


    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Execute_JavaScript</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Execute_JavaScript&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>

        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>

        <span class="c1"># =======================================================================</span>
        <span class="c1"># action = webdriver.ActionChains(env.threadlocal.BROWSER)</span>
        <span class="c1"># action.key_up(Keys.CONTROL, elements[cls.index])</span>
        <span class="c1"># action.perform()</span>
        <span class="c1">#</span>
        <span class="c1"># action.click(elements[cls.index])</span>
        <span class="c1"># action.perform()</span>
        <span class="c1"># =======================================================================</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>

    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Execute_JavaScriptWithArgs</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Execute_JavaScript&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>

        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="n">js</span><span class="p">,</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

        <span class="c1"># =======================================================================</span>
        <span class="c1"># action = webdriver.ActionChains(env.threadlocal.BROWSER)</span>
        <span class="c1"># action.key_up(Keys.CONTROL, elements[cls.index])</span>
        <span class="c1"># action.perform()</span>
        <span class="c1">#</span>
        <span class="c1"># action.click(elements[cls.index])</span>
        <span class="c1"># action.perform()</span>
        <span class="c1"># =======================================================================</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>

    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">ClickTillObjAppear</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DESCRIPTION</span>
<span class="sd">            Sometimes, one click on the element doesn&#39;t work. So wait 3 seconds, then </span>
<span class="sd">            click again and again until the expected object &quot;obj&quot; appear.</span>
<span class="sd">        </span>
<span class="sd">        RISK</span>
<span class="sd">            It may do click() for many times!!!</span>
<span class="sd">        </span>
<span class="sd">        EXAMPLES</span>
<span class="sd">            Login.LoginButton.ClickTillObjAppear(OverView.LatestClaims.Button_Office())</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: ClickTillObjAppear()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">Click</span><span class="p">()</span>
        
        <span class="c1">#=======================================================================</span>
        <span class="c1"># cls.__wait()</span>
        <span class="c1"># elements = env.threadlocal.BROWSER.find_elements(cls.by, cls.value)</span>
        <span class="c1"># </span>
        <span class="c1"># i = 0</span>
        <span class="c1"># while obj.GetRealTimeObjCount() == 0:</span>
        <span class="c1">#     try:</span>
        <span class="c1">#         action = webdriver.ActionChains(env.threadlocal.BROWSER)</span>
        <span class="c1">#         action.click(elements[cls.index])</span>
        <span class="c1">#         action.perform()</span>
        <span class="c1">#         </span>
        <span class="c1">#         log.step_normal(&quot;click [%s] times...&quot; % i)</span>
        <span class="c1">#         time.sleep(5)</span>
        <span class="c1">#         </span>
        <span class="c1">#         i = i + 1</span>
        <span class="c1">#         if i == 2:</span>
        <span class="c1">#             log.step_normal(&quot;too many clicking times....&quot;)</span>
        <span class="c1">#             break</span>
        <span class="c1">#     except:</span>
        <span class="c1">#         log.step_normal(sys.exc_info()[0])</span>
        <span class="c1"># </span>
        <span class="c1"># cls.__clearup()</span>
        <span class="c1">#=======================================================================</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">ClickTillObjDisappear</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DESCRIPTION</span>
<span class="sd">            Sometimes, one click on the element doesn&#39;t work. So wait 3 seconds, then </span>
<span class="sd">            click again and again until the expected object &quot;obj&quot; disappear.</span>
<span class="sd">        </span>
<span class="sd">        RISK</span>
<span class="sd">            It may do click() for many times!!!</span>
<span class="sd">        </span>
<span class="sd">        EXAMPLES</span>
<span class="sd">            Login.LoginButton.ClickTillObjDisappear(OverView.Button_Office())</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: ClickTillObjDisappear()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">Click</span><span class="p">()</span>
        
        <span class="c1">#=======================================================================</span>
        <span class="c1"># cls.__wait()</span>
        <span class="c1"># elements = env.threadlocal.BROWSER.find_elements(cls.by, cls.value)</span>
        <span class="c1"># </span>
        <span class="c1"># i = 0</span>
        <span class="c1"># while True:</span>
        <span class="c1">#     if obj.GetRealTimeObjCount() == 0:</span>
        <span class="c1">#         break</span>
        <span class="c1">#     </span>
        <span class="c1">#     try:</span>
        <span class="c1">#         action = webdriver.ActionChains(env.threadlocal.BROWSER)</span>
        <span class="c1">#         action.click(elements[cls.index])</span>
        <span class="c1">#         action.perform()</span>
        <span class="c1">#     except:</span>
        <span class="c1">#         log.step_normal(sys.exc_info()[0])</span>
        <span class="c1">#     </span>
        <span class="c1">#     log.step_normal(&quot;click [%s] times...&quot; % i)</span>
        <span class="c1">#     time.sleep(5)</span>
        <span class="c1">#     </span>
        <span class="c1">#     i = i + 1</span>
        <span class="c1">#     if i == 2:</span>
        <span class="c1">#         log.step_fail(&quot;too many clicking times....&quot;)</span>
        <span class="c1">#         break</span>
        <span class="c1"># </span>
        <span class="c1"># cls.__clearup()</span>
        <span class="c1">#=======================================================================</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">DoubleClick</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: DoubleClick()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">double_click</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">ClickAndHold</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: ClickAndHold()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">click_and_hold</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>

    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">DragAndDropByOffset</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">xoffset</span><span class="p">,</span> <span class="n">yoffset</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Holds down the left mouse button on the source element,</span>
<span class="sd">        then moves to the target offset and releases the mouse button.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: drag_and_drop_by_offset()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">drag_and_drop_by_offset</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">],</span><span class="n">xoffset</span><span class="p">,</span> <span class="n">yoffset</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">ReleaseClick</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: ReleaseClick()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">release</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">TypeIn</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">Clear</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Input value without clear existing values</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: TypeIn [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">Clear</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;document.getElementById(&#39;username&#39;)&quot;</span><span class="p">)</span>
        <span class="c1">#=======================================================================</span>
        <span class="c1"># action = webdriver.ActionChains(env.threadlocal.BROWSER)</span>
        <span class="c1"># action.send_keys_to_element(elements[cls.index], value)</span>
        <span class="c1"># action.perform()</span>
        <span class="c1">#=======================================================================</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>

    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SendEnter</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: SendEnter()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">send_keys_to_element</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>

    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">SendPageDown</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: SendPageDown()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,))</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">send_keys_to_element</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">Keys</span><span class="o">.</span><span class="n">PAGE_DOWN</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>

        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetObjectsCount</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetObjectsCount.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="c1">#cls.__wait_for_appearing()</span>
        
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetObjectsCount = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetRealTimeObjCount</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span> <span class="c1">#### get real time obj counts, without waiting.</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetRealTimeObjCount = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetElementObj</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span> <span class="c1">#### get real time obj counts, without waiting.</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetElementObj.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetInnerHTML</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetInnerHTML()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: InnerHTML = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetAttribute</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetAttribute [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">attr_value</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Attribute Value = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">attr_value</span>

    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetParentElement</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: GetParentElement()&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>


    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">GetText</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Gets the text of the element, the content is [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">FetchSubElementOfXPath</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">WebElement</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="n">layer</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">Wait</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Wait for [</span><span class="si">%s</span><span class="s2">] seconds.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">seconds</span><span class="p">))</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">WaitForAttribute</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        Example:</span>
<span class="sd">            NewClaim.Dates.ReminderDate.WaitForAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;equal&#39;)</span>
<span class="sd">            NewClaim.Dates.ReminderDate.WaitForAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;contain&#39;)</span>
<span class="sd">            NewClaim.Dates.ReminderDate.WaitForAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;not contain&#39;)</span>
<span class="sd">            NewClaim.Dates.ReminderDate.WaitForAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;in&#39;)</span>
<span class="sd">            NewClaim.Dates.ReminderDate.WaitForAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;not equal&#39;)</span>
<span class="sd">        </span>
<span class="sd">        Description for &quot;method&quot;:</span>
<span class="sd">            equal  =&gt; real value is &#39;hello&#39;</span>
<span class="sd">            has    =&gt; real value contains &#39;hello&#39;, e.g. &#39;hello world&#39;.</span>
<span class="sd">            in     =&gt; real value in &#39;hello&#39;, e.g. &#39;he&#39;</span>
<span class="sd">            differ =&gt; real value not equal to &#39;hello&#39;, e.g. &#39;hehe&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WaitForAttribute [</span><span class="si">%s</span><span class="s2">] &lt;</span><span class="si">%s</span><span class="s2">&gt; [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            
            <span class="n">realvalue</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;equal&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">realvalue</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Yes! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;No! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
            
            <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;contain&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">realvalue</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Yes! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">[:</span><span class="mi">150</span><span class="p">])</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;No! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">[:</span><span class="mi">150</span><span class="p">])</span>
            
            <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not contain&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">realvalue</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Yes! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">[:</span><span class="mi">150</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;No! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">[:</span><span class="mi">150</span><span class="p">])</span>
                    <span class="k">break</span>
            
            <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">realvalue</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Yes! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">[:</span><span class="mi">150</span><span class="p">])</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;No! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">[:</span><span class="mi">150</span><span class="p">])</span>
            
            <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not equal&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">realvalue</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;No! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Yes! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
                    <span class="k">break</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;code error.&quot;</span><span class="p">)</span>
            
            
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Not Found Expected Value! real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
                <span class="k">break</span>
            
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="c1">#===========================================================================</span>
    <span class="c1"># @compatiblemethod</span>
    <span class="c1"># def WaitForAttributeContains(cls, attr_name, attr_value):</span>
    <span class="c1">#     log.step_normal(&quot;Element [%s]: WaitForAttribute [%s] = [%s].&quot; % (cls.__name__, attr_name, attr_value))</span>
    <span class="c1">#     </span>
    <span class="c1">#     i = 0</span>
    <span class="c1">#     while True:</span>
    <span class="c1">#         cls.__wait()</span>
    <span class="c1">#         elements = env.threadlocal.BROWSER.find_elements(cls.by, cls.value)</span>
    <span class="c1">#         </span>
    <span class="c1">#         real_value = elements[cls.index].get_attribute(attr_name)</span>
    <span class="c1">#         </span>
    <span class="c1">#         </span>
    <span class="c1">#         if not isinstance(real_value, unicode):</span>
    <span class="c1">#             print &quot;not !!&quot;</span>
    <span class="c1">#             real_value = real_value.encode(&#39;utf-8&#39;)</span>
    <span class="c1">#         </span>
    <span class="c1">#         </span>
    <span class="c1">#         if attr_value.upper() in real_value.upper():</span>
    <span class="c1">#             log.step_normal(&quot;Yes! real_value=[%s]&quot; % real_value)</span>
    <span class="c1">#             break</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             log.step_normal(&quot;No! real_value=[%s]&quot; % real_value)</span>
    <span class="c1">#         </span>
    <span class="c1">#         i = i + 1</span>
    <span class="c1">#         if i &gt; 60:</span>
    <span class="c1">#             log.step_fail(&quot;Not Found Expected Value! real_value=[%s]&quot; % real_value)</span>
    <span class="c1">#             break</span>
    <span class="c1">#         </span>
    <span class="c1">#         time.sleep(3)</span>
    <span class="c1">#     </span>
    <span class="c1">#     </span>
    <span class="c1">#     cls.__clearup()</span>
    <span class="c1">#===========================================================================</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">WaitForAppearing</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">lastTime</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WaitForAppearing...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait_for_appearing</span><span class="p">(</span><span class="n">lastTime</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">WaitForDisappearing</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">lastTime</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WaitForDisappearing...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait_for_disappearing</span><span class="p">(</span><span class="n">lastTime</span><span class="p">)</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">WaitForVisible</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WaitForVisible...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span><span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: IS visible now.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Still NOT visible, wait 1 second.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">WaitForEnabled</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WaitForEnabled...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span><span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: is enabled now.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: still NOT enabled, wait 1 second.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.IsEnabled"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.IsEnabled">[文档]</a>    <span class="k">def</span> <span class="nf">IsEnabled</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element is enabled, use the function is_enabled(), of attribute enabled/disabled.</span>

<span class="sd">            :Example:</span>
<span class="sd">                + User.UserSaveButton.IsEnabled()</span>

<span class="sd">            :Return:</span>
<span class="sd">                + true: if the element control is enabled.</span>
<span class="sd">                + false: if the element control is disabled.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Is Enabled?&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Yes!&quot;</span><span class="p">)</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;No!&quot;</span><span class="p">)</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span></div>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.IsExist"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.IsExist">[文档]</a>    <span class="k">def</span> <span class="nf">IsExist</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element is existed, by find_elements().length &gt; 0.</span>

<span class="sd">            :Example:</span>
<span class="sd">                + User.UserSaveButton.IsExist()</span>

<span class="sd">            :Return:</span>
<span class="sd">                + true: if the element control is existed.</span>
<span class="sd">                + false: if the element control is not existed.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: IsExist?&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: IsExist? Count = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.IsVisible"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.IsVisible">[文档]</a>    <span class="k">def</span> <span class="nf">IsVisible</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element is visible, use the function is_displayed(), of attribute [display:none].</span>

<span class="sd">            :Example:</span>
<span class="sd">                + User.UserSaveButton.IsVisible()</span>

<span class="sd">            :Return:</span>
<span class="sd">                + true: if the element control is visible.</span>
<span class="sd">                + false: if the element control is not visible, there is [display:none] in the style.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: IsVisible?&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span></div>
        
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.IsAttribute"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.IsAttribute">[文档]</a>    <span class="k">def</span> <span class="nf">IsAttribute</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;contain&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element&#39;s attribute [name]&#39;s value &lt;method&gt; [value].</span>

<span class="sd">            :Examples:</span>
<span class="sd">                + User.UserSaveButton.IsAttribute(&quot;color&quot;, &quot;rgb(118, 122, 122)&quot;, &quot;equal&quot;)</span>

<span class="sd">            :param name: the attribute name, e.g. font-size, text (css attribute)</span>
<span class="sd">            :param value: the Expected value of attribute value which need to verify</span>
<span class="sd">            :param method: the verification method of acutal [name]&#39;s value and expected value [value]</span>
<span class="sd">                           method default value is &#39;contain&#39;</span>
<span class="sd">                           method option: &#39;equal&#39;|&#39;not equal&#39;|&#39;contain&#39;|&#39;not contain&#39;|&#39;in&#39;</span>

<span class="sd">            :Return:</span>
<span class="sd">                + true: if the element&#39;s attribute [name]&#39;s value &lt;method&gt; [value].</span>
<span class="sd">                + false: if the element&#39;s attribute [name]&#39;s value not &lt;method&gt; [value].</span>
<span class="sd">                + Case is failed if the method is not in (&#39;equal&#39;|&#39;not equal&#39;|&#39;contain&#39;|&#39;not contain&#39;|&#39;in&#39;), and log &quot;code error&quot;</span>
<span class="sd">                    &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: IsAttribute [</span><span class="si">%s</span><span class="s2">] &lt;</span><span class="si">%s</span><span class="s2">&gt; [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">realvalue</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;equal&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not equal&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="o">==</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;contain&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not contain&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">realvalue</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>
        
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;code error.&quot;</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span></div>
    

<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.VerifyObjectCount"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.VerifyObjectCount">[文档]</a>    <span class="k">def</span> <span class="nf">VerifyObjectCount</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element&#39;s count is equal to [number]</span>

<span class="sd">            :Examples:</span>
<span class="sd">                + Ticket.TicketItem.VerifyObjectCount(10)</span>

<span class="sd">            :param number: the Expected number of element</span>

<span class="sd">            :Return:</span>
<span class="sd">                + pass: if the element&#39;s attribute [name]&#39;s value &lt;method&gt; [value].</span>
<span class="sd">                + fail: if the element&#39;s attribute [name]&#39;s value not &lt;method&gt; [value].</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Verify Object Count&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>

        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">realNumber</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Count = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">realNumber</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">realNumber</span> <span class="o">==</span> <span class="n">number</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Verify Object Count = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">realNumber</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Verify Actual Object Count = [</span><span class="si">%s</span><span class="s2">], But Expected Object number = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">realNumber</span><span class="p">,</span> <span class="n">number</span><span class="p">))</span></div>

    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.VerifyExistence"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.VerifyExistence">[文档]</a>    <span class="k">def</span> <span class="nf">VerifyExistence</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">trueORfalse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element is existed or not.</span>

<span class="sd">            :Examples:</span>
<span class="sd">                + User.UserSaveButton.VerifyExistence(False)</span>
<span class="sd">                + User.UserSaveButton.VerifyExistence(True)</span>

<span class="sd">            :param trueORfalse: True/False</span>

<span class="sd">            :Return:</span>
<span class="sd">                + pass: if trueORfalse == True and the element is existed.</span>
<span class="sd">                + pass: if trueORfalse == False and the element is not existed.</span>
<span class="sd">                + fail: if trueORfalse == True and the element is not existed.</span>
<span class="sd">                + fail: if trueORfalse == False and the element is existed.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Verify Existence = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">trueORfalse</span><span class="p">))</span>
        
        <span class="c1">#if trueORfalse == True:</span>
            <span class="c1">#cls.__wait_for_appearing()</span>
        <span class="c1">#else:</span>
            <span class="c1">#cls.__wait_for_disappearing()</span>
        
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Count = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)))</span>
        
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trueORfalse</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Exist!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Exist!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trueORfalse</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Not Exist!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Not Exist!&quot;</span><span class="p">)</span></div>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.VerifyVisible"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.VerifyVisible">[文档]</a>    <span class="k">def</span> <span class="nf">VerifyVisible</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">trueORfalse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element is visible or not, use the function is_displayed(), of attribute [display:none].</span>

<span class="sd">            :Examples:</span>
<span class="sd">                + User.UserSaveButton.VerifyVisible(False)</span>
<span class="sd">                + User.UserSaveButton.VerifyVisible(True)</span>

<span class="sd">            :param trueORfalse: True/False</span>

<span class="sd">            :Return:</span>
<span class="sd">                + pass: if trueORfalse == True and the element is displayed.</span>
<span class="sd">                + pass: if trueORfalse == False and the element is not displayed.</span>
<span class="sd">                + fail: if trueORfalse == True and the element is not displayed.</span>
<span class="sd">                + fail: if trueORfalse == False and the element is displayed.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Verify Visible = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">trueORfalse</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Count = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)))</span>
        
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">trueORfalse</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Visible!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Visible!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trueORfalse</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Not Visible!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Not Visible!&quot;</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span></div>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.VerifyEnabled"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.VerifyEnabled">[文档]</a>    <span class="k">def</span> <span class="nf">VerifyEnabled</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">trueOrfalse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element is enabled or not, use the function is_enabled()</span>

<span class="sd">            :Examples:</span>
<span class="sd">                + User.UserSaveButton.VerifyEnabled(False)</span>
<span class="sd">                + User.UserSaveButton.VerifyEnabled(True)</span>

<span class="sd">            :param trueORfalse: True/False</span>

<span class="sd">            :Return:</span>
<span class="sd">                + pass: if trueORfalse == True and the element is enabled.</span>
<span class="sd">                + pass: if trueORfalse == False and the element is not enabled.</span>
<span class="sd">                + fail: if trueORfalse == True and the element is not enabled.</span>
<span class="sd">                + fail: if trueORfalse == False and the element is enabled.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: Verify Enabled = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">trueOrfalse</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">is_disabled</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">u&quot;Element [</span><span class="si">%s</span><span class="s2">]: attribute &#39;is_disabled&#39; = [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">is_disabled</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">is_disabled</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trueOrfalse</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Pass...&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Fail...&quot;</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">trueOrfalse</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Pass&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Fail&quot;</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Not verified.&quot;</span><span class="p">)</span>
        
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span></div>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.VerifyInnerHTMLContains"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.VerifyInnerHTMLContains">[文档]</a>    <span class="k">def</span> <span class="nf">VerifyInnerHTMLContains</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">contain_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify that if the element&#39;s atrribute&lt;innerHTML》 value contains [contain_content]</span>

<span class="sd">            :Examples:</span>
<span class="sd">                + &lt;Element_Class&gt;.VerifyInnerHTMLContains(&quot;&lt;body hello world! /body&gt;&quot;)</span>
<span class="sd">                + Not use this method until now.</span>

<span class="sd">            :param contain_content: it&#39;s type can be &lt;List&gt; or &lt;string&gt;, the expected content.</span>

<span class="sd">            :Return:</span>
<span class="sd">                + pass: if &lt;contain_content&gt; is list, all the item is in [get_attribute(&#39;innerHTML&#39;)]</span>
<span class="sd">                        if contain_content is string, the content string is in [get_attribute(&#39;innerHTML&#39;)]</span>
<span class="sd">                + fail: if &lt;contain_content&gt; is list, not all the item in [get_attribute(&#39;innerHTML&#39;)]</span>
<span class="sd">                        if contain_content is string, the content string is not in [get_attribute(&#39;innerHTML&#39;)]</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: VerifyInnerHTMLContains [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">contain_content</span><span class="p">)))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">inner_html</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contain_content</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">contain_content</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">inner_html</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Real inner_hmtl=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">inner_html</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Real inner_hmtl=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">inner_html</span><span class="p">)</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">contain_content</span> <span class="ow">in</span> <span class="n">inner_html</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;Real inner_hmtl=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">inner_html</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Real inner_hmtl=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">inner_html</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span></div>
    
    
<span class="c1">#    @compatiblemethod</span>
<div class="viewcode-block" id="WebElement.VerifyAttribute"><a class="viewcode-back" href="../../knitter.html#knitter.webelement.WebElement.VerifyAttribute">[文档]</a>    <span class="k">def</span> <span class="nf">VerifyAttribute</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Verify that if the element&#39;s attribute [name]&#39;s value &lt;method&gt; [value].</span>

<span class="sd">            :Example:</span>
<span class="sd">                + DatePicker.ReminderDate.VerifyAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;equal&#39;)</span>
<span class="sd">                + DatePicker.ReminderDate.VerifyAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;contain&#39;)</span>
<span class="sd">                + DatePicker.ReminderDate.VerifyAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;in&#39;)</span>
<span class="sd">                + DatePicker.ReminderDate.VerifyAttribute(&#39;ng-model&#39;, &#39;hello&#39;, method=&#39;not equal&#39;)</span>
<span class="sd">        </span>
<span class="sd">            :Description for &quot;method&quot;:</span>
<span class="sd">                + equal  =&gt; real value is &#39;hello&#39;</span>
<span class="sd">                + has    =&gt; real value contains &#39;hello&#39;, e.g. &#39;hello world&#39;.</span>
<span class="sd">                + in     =&gt; real value in &#39;hello&#39;, e.g. &#39;he&#39;</span>
<span class="sd">                + differ =&gt; real value not equal to &#39;hello&#39;, e.g. &#39;hehe&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: VerifyAttribute [</span><span class="si">%s</span><span class="s2">] &lt;</span><span class="si">%s</span><span class="s2">&gt; [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__wait</span><span class="p">()</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">realvalue</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;equal&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not equal&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="o">==</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;contain&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not contain&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">realvalue</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">realvalue</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_pass</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;real value=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">realvalue</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;code error.&quot;</span><span class="p">)</span>
        
        <span class="n">cls</span><span class="o">.</span><span class="n">__clearup</span><span class="p">()</span></div>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">__wait_for_enabled</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">elements</span><span class="p">[</span><span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
                    <span class="k">break</span>
                
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: __wait_for_enabled for 1 second, By [</span><span class="si">%s</span><span class="s2"> :: </span><span class="si">%s</span><span class="s2"> :: </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">__wait</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">120</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: NoSuchElementException.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">except</span> <span class="n">BadStatusLine</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: BadStatusLine.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">UnexpectedAlertPresentException</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: UnexpectedAlertPresentException.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Wait 0.5 second, By [</span><span class="si">%s</span><span class="s2"> :: </span><span class="si">%s</span><span class="s2"> :: </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: There are [</span><span class="si">%s</span><span class="s2">] Elements!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)))</span>
                
                <span class="k">break</span>
        
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">cls</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_fail</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Element Index Issue! There are [</span><span class="si">%s</span><span class="s2">] Elements! Index=[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">),</span> <span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        
        
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">__wait_for_disappearing</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">lastTime</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">lastTime</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: NoSuchElementException.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">except</span> <span class="n">BadStatusLine</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: BadStatusLine.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">UnexpectedAlertPresentException</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: UnexpectedAlertPresentException.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WairForDisappearing... Found [</span><span class="si">%s</span><span class="s2">] Element. Tried [</span><span class="si">%s</span><span class="s2">] Times.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span>
        
        
        <span class="k">return</span> <span class="kc">False</span>
    
    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">__wait_for_appearing</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">lastTime</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
        
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">lastTime</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">threadlocal</span><span class="o">.</span><span class="n">BROWSER</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">by</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: NoSuchElementException.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">except</span> <span class="n">BadStatusLine</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: BadStatusLine.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">UnexpectedAlertPresentException</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_warning</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: UnexpectedAlertPresentException.&quot;</span> <span class="o">%</span> <span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: WaitForAppearing... Wait 1 second, By [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: Found [</span><span class="si">%s</span><span class="s2">] Element. Tried [</span><span class="si">%s</span><span class="s2">] Times.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span>
                <span class="k">break</span>
        

    
    <span class="nd">@compatiblemethod</span>
    <span class="k">def</span> <span class="nf">__clearup</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">step_normal</span><span class="p">(</span><span class="s2">&quot;Element [</span><span class="si">%s</span><span class="s2">]: The Operation Element Index = [</span><span class="si">%s</span><span class="s2">].&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">cls</span><span class="o">.</span><span class="n">index</span><span class="p">))</span></div>
        
<span class="c1">#         cls.index = 0</span>





</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">模块代码</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>快速搜索</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="转向" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, emma.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.8</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>